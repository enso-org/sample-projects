from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Microsoft import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Examples
import Standard.Visualization

main =
    quot1 = enso_project.data/ 'shifts_worked.csv'
    any1 = Data.read quot1
    table2 = any1.split_to_columns 'Column 1' ','
    table1 = table2.use_first_row_as_names
    table3 = table1.parse
    any2 = table3.aggregate ['Employee_ID'] [..Minimum 'Shift Dates' "First Shift"]
    any8 = any2.set (expr 'date_diff([First Shift],#2024-12-31#,..day) +1') "Potential Work Days"
    any4 = table3.set (expr 'if [Shift Duration] >5 then 1 else 0') "Shift Above 5 Hours"
    any5 = any4.set (expr 'if [Shift Duration] <=5 then 1 else 0') "Shift Below 5 Hours"
    any3 = any5.aggregate ['Employee_ID'] [..Count_Distinct ['Shift Dates'] "Total Shifts Taken", ..Sum 'Shift Above 5 Hours' "Shifts Above 5 Hours", ..Sum 'Shift Below 5 Hours' "Shifts Below 5 Hours"]
    table4 = any3.join any8 ..Inner [(..Equals 'Employee_ID')]
    any9 = table4.set (expr '[Potential Work Days]-[Total Shifts Taken]') "Non Work Days"
    any12 = any9.set (expr 'round([Shifts Below 5 Hours]/[Total Shifts Taken],4)*100') "Percent Below 5 Hours"
    any11 = any12.select_columns ['Employee_ID', 'Total Shifts Taken', 'Non Work Days', 'Shifts Above 5 Hours', 'Shifts Below 5 Hours', 'Percent Below 5 Hours'] True



#### METADATA ####
[[{"index":{"value":338},"size":{"value":18}},"d690a75c-b030-4cfa-8b05-53d319703258"],[{"index":{"value":338},"size":{"value":38}},"28a79736-ddbb-45bc-a654-76954e58a284"],[{"index":{"value":388},"size":{"value":9}},"4c77770a-4df3-4ce1-be11-951e31dc1a85"],[{"index":{"value":388},"size":{"value":15}},"521c6488-bd95-49e4-9d3f-5857b6732f61"],[{"index":{"value":417},"size":{"value":21}},"6757f952-751c-4c06-9184-0be67613fc93"],[{"index":{"value":417},"size":{"value":32}},"60470bdc-0a51-428e-a550-bffbad56fd1b"],[{"index":{"value":417},"size":{"value":36}},"7b653431-cf8a-4b65-9a08-06b35c895e43"],[{"index":{"value":467},"size":{"value":29}},"fa986d98-76d2-4630-b843-f04c12571d6f"],[{"index":{"value":510},"size":{"value":12}},"9b88d109-a8e3-4d63-95e4-a5224b39c4a1"],[{"index":{"value":534},"size":{"value":16}},"6b55b3e9-9156-4aea-9388-1622c79a53e3"],[{"index":{"value":534},"size":{"value":32}},"e705c27e-3349-47b4-aa02-33aa88c34ba0"],[{"index":{"value":534},"size":{"value":72}},"59463700-c0a6-47e0-b147-591e097536d5"],[{"index":{"value":618},"size":{"value":8}},"c6ac3f0f-49d2-4ba4-b805-ab9826fe288c"],[{"index":{"value":618},"size":{"value":64}},"1c87399a-f1ce-476c-b2c5-d625f717cdb6"],[{"index":{"value":618},"size":{"value":86}},"1dade4ce-4b87-412a-8373-7df08ccaea1c"],[{"index":{"value":716},"size":{"value":10}},"27f7c25c-b5de-4603-9f37-34ca3c4db4a1"],[{"index":{"value":716},"size":{"value":56}},"3af19aa1-e0d1-4814-b591-2338423f5cb6"],[{"index":{"value":716},"size":{"value":78}},"673b756a-6da6-4163-9363-0dae612b6af3"],[{"index":{"value":806},"size":{"value":77}},"f93ebc2c-4cb8-45ee-a352-c10bccb072bc"],[{"index":{"value":895},"size":{"value":14}},"8de59534-403a-407b-90ff-014204a861f6"],[{"index":{"value":895},"size":{"value":30}},"7a3ef0dd-39ef-4adc-858e-752ae09682c5"],[{"index":{"value":895},"size":{"value":190}},"ebb1da9e-e1a7-42c8-bfa0-1f8369da8a53"],[{"index":{"value":1099},"size":{"value":9}},"671f25e8-298c-49fb-90b0-42015b242646"],[{"index":{"value":1099},"size":{"value":14}},"01b7cc7d-6b35-4dda-ba7f-d493947576f8"],[{"index":{"value":1099},"size":{"value":22}},"0f88220c-5379-42b5-bdbc-4d25a36c8a6d"],[{"index":{"value":1099},"size":{"value":49}},"1858dae1-3d83-4761-9e8a-9ce3cb75d404"],[{"index":{"value":1160},"size":{"value":10}},"534fa4bf-2793-49d2-89b7-0444bbfd7b21"],[{"index":{"value":1160},"size":{"value":62}},"5c79f888-71eb-4443-84d5-b36874c6da24"],[{"index":{"value":1160},"size":{"value":78}},"405eefb6-7e0b-40eb-8d05-91a4298436b5"],[{"index":{"value":1251},"size":{"value":8}},"7bbca5f9-c5fd-46d2-b462-1121b6f18af8"],[{"index":{"value":1251},"size":{"value":74}},"7a04628c-ad51-4816-b685-3707ee11fa9c"],[{"index":{"value":1251},"size":{"value":98}},"6b4b942c-a7c5-4c94-bdf1-16c3733846d8"],[{"index":{"value":1362},"size":{"value":20}},"52dee9ba-b566-481e-9530-a275fbd528d5"],[{"index":{"value":1362},"size":{"value":148}},"cfaaa215-3773-4d08-9ec7-0fe2fa69aaf4"],[{"index":{"value":1362},"size":{"value":153}},"f6fee1af-69bc-480c-90b5-e88b67a2932f"]]
{"ide":{"node":{"28a79736-ddbb-45bc-a654-76954e58a284":{"position":{"vector":[80,448]}},"d690a75c-b030-4cfa-8b05-53d319703258":{"position":{"vector":[758,113]}},"521c6488-bd95-49e4-9d3f-5857b6732f61":{"position":{"vector":[53,376]},"visualization":{"show":true,"width":659.8610074626865,"height":168.61007462686567}},"4c77770a-4df3-4ce1-be11-951e31dc1a85":{"position":{"vector":[356,63]}},"7b653431-cf8a-4b65-9a08-06b35c895e43":{"position":{"vector":[53,136]},"visualization":{"show":false,"width":549.265625}},"60470bdc-0a51-428e-a550-bffbad56fd1b":{"position":{"vector":[86,-139]}},"6757f952-751c-4c06-9184-0be67613fc93":{"position":{"vector":[86,-139]}},"fa986d98-76d2-4630-b843-f04c12571d6f":{"position":{"vector":[53,64]},"visualization":{"show":false,"width":710.9593633395522}},"9b88d109-a8e3-4d63-95e4-a5224b39c4a1":{"position":{"vector":[53,-8]},"visualization":{"show":false,"width":723.1371268656716}},"59463700-c0a6-47e0-b147-591e097536d5":{"position":{"vector":[130,-224]}},"e705c27e-3349-47b4-aa02-33aa88c34ba0":{"position":{"vector":[53,-427]}},"6b55b3e9-9156-4aea-9388-1622c79a53e3":{"position":{"vector":[53,-336]}},"1dade4ce-4b87-412a-8373-7df08ccaea1c":{"position":{"vector":[130,-296]},"visualization":{"show":true,"width":696.9624533582089}},"1c87399a-f1ce-476c-b2c5-d625f717cdb6":{"position":{"vector":[1113,-668]}},"c6ac3f0f-49d2-4ba4-b805-ab9826fe288c":{"position":{"vector":[1113,-668]}},"673b756a-6da6-4163-9363-0dae612b6af3":{"position":{"vector":[53,-80]}},"3af19aa1-e0d1-4814-b591-2338423f5cb6":{"position":{"vector":[1079,-324]}},"27f7c25c-b5de-4603-9f37-34ca3c4db4a1":{"position":{"vector":[1079,-324]}},"f93ebc2c-4cb8-45ee-a352-c10bccb072bc":{"position":{"vector":[53,-152]},"visualization":{"show":false,"width":1143.5669309701493}},"ebb1da9e-e1a7-42c8-bfa0-1f8369da8a53":{"position":{"vector":[53,-518]},"visualization":{"show":true,"height":156.86293143656718}},"7a3ef0dd-39ef-4adc-858e-752ae09682c5":{"position":{"vector":[73,-719]}},"8de59534-403a-407b-90ff-014204a861f6":{"position":{"vector":[73,-719]}},"1858dae1-3d83-4761-9e8a-9ce3cb75d404":{"position":{"vector":[53,-772]},"visualization":{"show":false,"width":1346.9675839552237}},"0f88220c-5379-42b5-bdbc-4d25a36c8a6d":{"position":{"vector":[-74,-790]}},"01b7cc7d-6b35-4dda-ba7f-d493947576f8":{"position":{"vector":[-74,-790]}},"671f25e8-298c-49fb-90b0-42015b242646":{"position":{"vector":[-74,-790]}},"405eefb6-7e0b-40eb-8d05-91a4298436b5":{"position":{"vector":[53,-844]}},"5c79f888-71eb-4443-84d5-b36874c6da24":{"position":{"vector":[1010,-900]}},"534fa4bf-2793-49d2-89b7-0444bbfd7b21":{"position":{"vector":[1010,-882]}},"6b4b942c-a7c5-4c94-bdf1-16c3733846d8":{"position":{"vector":[53,-916]}},"7a04628c-ad51-4816-b685-3707ee11fa9c":{"position":{"vector":[1427,-1942]}},"7bbca5f9-c5fd-46d2-b462-1121b6f18af8":{"position":{"vector":[1427,-1942]}},"f6fee1af-69bc-480c-90b5-e88b67a2932f":{"position":{"vector":[53,-988]},"visualization":{"show":true,"width":1442.99609375,"height":246.51171875}},"cfaaa215-3773-4d08-9ec7-0fe2fa69aaf4":{"position":{"vector":[137,-1148]}},"52dee9ba-b566-481e-9530-a275fbd528d5":{"position":{"vector":[137,-1148]}}},"widget":{},"import":{},"snapshot":"eJyFU9tO20AQfc9XjMLDJq1ZcC5SkZpKQGjLAxVSovJgWdZgj8OS9a7ZXRPSr69s52aSwNtqLmfOmTObGp3BxKFK0CT8Ci2ByHJtHKCUrbSRneKj/CA9RoePHwJcPkyOJ39pPZMUXebieM2diI22OnXHSyZKL1KJ8890YLFbsHpuSm7eMMsl2b3EX2ELlOIfOqFVq5WhUDBqAQC8FNr5MAJSVke50c8UO56gwzNg9kmkzkYLbeaU8Ni+sqoF1bLsKBfHDWFSY1QpV3Lswaiq4TaXwkVOR7GWRaYssOvqAT4D5rFtRwlXt/LCUpQKY11k9CJCGynMyG5L++tSn+doLK0Z9dbxPsfZzNAMHUHAbrJc6iVRdDtmIQSc3wklsiIDNinFlSLIMmj/LEdCFWuHa8xvtZAet+SgQ2+5AZagoygRadoJdnpC76R33huc+r3Tvn/icZ7gsgtffdaF9r12pJxACQ/azGGMS9teTxhsWe/MECkEK3qFqSwL4ccQ3BMp8IGkJTgvkeuay0f9SjCE37owW+RhzX3wGe730VHgK5J6sQfcr4GHH6/5WhfKRWNhnVCxg6Cx7hDaU+1Q1ruzMMU5qbYHnE+2zjRksRUn+07tu54G421PU0i4PaZBraXPn7VQteOc3ypFBoIO5zcvBUoLDXXdzXVcrL1r7Dg4YHd4GuzrDctF/9HqwFX4qx90sQtsdKGSTnBIUnh2CN8bdL/455Wf92RiUscc9f3Vhy0PXVLsNv+1aawHbH9MGW2oKAOHvNqJN23ygB3kx0KYmoJa/wEJqu7l"}}