from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Microsoft import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Examples
import Standard.Visualization

## # Creating a Financial Close Calendar - 5th Working Day of Each Month


   The project aims to create a system for accurately determining the 5th working day of each month, as established by our CFO as the organizationâ€™s SLA deadline. This automated calculation will streamline critical business operations, improve efficiency, and ensure compliance with the set SLA. The resulting tool will provide clarity across departments, enabling better planning and resource allocation.
main =
    quot1 = enso_project.data/ 'calendar.csv'
    file1 = Data.read quot1 (..Delimited headers=..Has_Headers)
    table1 = file1.parse ['Date', 'Company Holidays'] ..Date 'M/d/yy'
    ## Calculate day_of_week - 1 is Monday, 7 is Sunday
    any1 = table1.set (expr 'day_of_week([Date])') "day_of_week"
    ## Remove Weekends
    any2 = any1.filter 'day_of_week' (..Equal_Or_Less 5)
    column1 = table1.get 'Company Holidays'
    any4 = any2.remove_columns ['day_of_week', 'Company Holidays']
    ## Remove Holidays from Calendar
    any3 = any4.filter 'Date' (..Is_In column1 ..Remove)
    ## Create a Month Column used for grouping in the next step
    any5 = any3.set (..Simple_Expr (..Name 'Date') (..Date ..Month)) "Month"
    table2 = any5.add_row_number "Day of Month" 1 group_by=['Month'] order_by=[(..Name 'Date' ..Ascending)]
    any6 = table2.filter 'Day of Month' (..Equal 5)



#### METADATA ####
[[{"index":{"value":819},"size":{"value":18}},"329f9c9d-e8c9-4807-b65e-69f344fe4eec"],[{"index":{"value":819},"size":{"value":33}},"12ee25e9-8515-4508-8262-07ae6a0f4853"],[{"index":{"value":865},"size":{"value":15}},"26acde0e-d8ba-431f-805f-f7bf7de40e5b"],[{"index":{"value":865},"size":{"value":51}},"fcf199e6-d2b1-44b7-be92-a47545d6a593"],[{"index":{"value":930},"size":{"value":11}},"afd8e174-cd9c-42cb-9d76-d2655fd2fe70"],[{"index":{"value":930},"size":{"value":40}},"96062060-7249-4465-9ba5-097f7e89fec3"],[{"index":{"value":930},"size":{"value":47}},"a35bb158-0ba9-439f-9afa-5c18be1bb1af"],[{"index":{"value":930},"size":{"value":56}},"a91c906e-67ea-41ab-a071-35f7bbb1a473"],[{"index":{"value":1054},"size":{"value":10}},"780a2714-16da-46b6-944f-bf5e08f88827"],[{"index":{"value":1054},"size":{"value":39}},"d78af2fe-86d2-4879-9c77-6aa52d7eab03"],[{"index":{"value":1054},"size":{"value":53}},"92997c46-0ade-4d35-9597-f6301e9fbd74"],[{"index":{"value":1142},"size":{"value":11}},"125738d2-1640-4232-a999-e58c5041cb05"],[{"index":{"value":1142},"size":{"value":25}},"8b141532-9bd9-43cf-878f-a6833a3068ff"],[{"index":{"value":1142},"size":{"value":45}},"0915741f-491d-4fc7-be4d-b1ebbc21234b"],[{"index":{"value":1202},"size":{"value":10}},"8b631f7b-15e7-446d-a4bd-dd7ccba544f2"],[{"index":{"value":1202},"size":{"value":29}},"3960436e-fc35-45ca-8b0c-f42a1527b4f5"],[{"index":{"value":1243},"size":{"value":19}},"bf685229-5d03-48e6-85f5-5a33e754cc58"],[{"index":{"value":1243},"size":{"value":55}},"65ca8dad-fc49-42ce-83e5-54e6f084d725"],[{"index":{"value":1347},"size":{"value":11}},"2f0d0954-417b-40f0-85f4-df723e3fc746"],[{"index":{"value":1347},"size":{"value":18}},"db9007b5-10da-4bbe-a021-25aa8fc95d8c"],[{"index":{"value":1347},"size":{"value":45}},"c66c5b55-16b1-49da-8b0a-17086e9b0bd3"],[{"index":{"value":1468},"size":{"value":8}},"26337e61-791f-46d9-89f8-dc5e9e5f2701"],[{"index":{"value":1468},"size":{"value":57}},"53bbea1e-6207-4a3e-8762-0c8d969a6bf9"],[{"index":{"value":1468},"size":{"value":65}},"53c24e42-9211-4aa8-9cb8-1af541fbbb80"],[{"index":{"value":1547},"size":{"value":19}},"b5d219da-2459-4793-afae-5e9ebdeadc81"],[{"index":{"value":1547},"size":{"value":34}},"50d9cab0-a693-4980-aba8-f16308763c71"],[{"index":{"value":1547},"size":{"value":36}},"bd033f42-a75f-45e2-9447-a609b73535e9"],[{"index":{"value":1547},"size":{"value":55}},"61e38332-cea2-4b5d-b5c7-4b3363304b70"],[{"index":{"value":1547},"size":{"value":94}},"5bbc2a4a-3a2c-4eb9-b9af-f63cf8585838"],[{"index":{"value":1653},"size":{"value":13}},"0e9c642f-4dd4-4120-9e87-b52f8a840418"],[{"index":{"value":1653},"size":{"value":28}},"89868e70-a07c-440f-870d-5de4d249c79f"],[{"index":{"value":1653},"size":{"value":40}},"5603c099-0143-43fa-81c0-13ff4d7030c8"]]
{"ide":{"node":{"12ee25e9-8515-4508-8262-07ae6a0f4853":{"position":{"vector":[49,387]}},"329f9c9d-e8c9-4807-b65e-69f344fe4eec":{"position":{"vector":[608,-475]}},"fcf199e6-d2b1-44b7-be92-a47545d6a593":{"position":{"vector":[-36,315]},"visualization":{"show":true,"width":1129.671875,"height":252}},"26acde0e-d8ba-431f-805f-f7bf7de40e5b":{"position":{"vector":[-36,315]},"visualization":{"show":true,"width":1129.671875,"height":252}},"a91c906e-67ea-41ab-a071-35f7bbb1a473":{"position":{"vector":[-36,-9]}},"a35bb158-0ba9-439f-9afa-5c18be1bb1af":{"position":{"vector":[213,-66]}},"96062060-7249-4465-9ba5-097f7e89fec3":{"position":{"vector":[213,-66]}},"afd8e174-cd9c-42cb-9d76-d2655fd2fe70":{"position":{"vector":[213,-66]}},"92997c46-0ade-4d35-9597-f6301e9fbd74":{"position":{"vector":[-36,-81]},"visualization":{"show":false,"width":590.55859375,"height":325.52734375}},"d78af2fe-86d2-4879-9c77-6aa52d7eab03":{"position":{"vector":[58,-253]}},"780a2714-16da-46b6-944f-bf5e08f88827":{"position":{"vector":[59,-256]}},"0915741f-491d-4fc7-be4d-b1ebbc21234b":{"position":{"vector":[-36,-153]},"visualization":{"show":false,"width":666.7734375,"height":218.171875}},"8b141532-9bd9-43cf-878f-a6833a3068ff":{"position":{"vector":[341,-645]}},"125738d2-1640-4232-a999-e58c5041cb05":{"position":{"vector":[341,-645]}},"3960436e-fc35-45ca-8b0c-f42a1527b4f5":{"position":{"vector":[553,-253]},"visualization":{"show":true,"width":407.9216634509633}},"8b631f7b-15e7-446d-a4bd-dd7ccba544f2":{"position":{"vector":[-36,-321]}},"65ca8dad-fc49-42ce-83e5-54e6f084d725":{"position":{"vector":[-36,-225]}},"bf685229-5d03-48e6-85f5-5a33e754cc58":{"position":{"vector":[671,-925]}},"c66c5b55-16b1-49da-8b0a-17086e9b0bd3":{"position":{"vector":[-36,-325]},"visualization":{"show":true}},"db9007b5-10da-4bbe-a021-25aa8fc95d8c":{"position":{"vector":[254,-984]}},"2f0d0954-417b-40f0-85f4-df723e3fc746":{"position":{"vector":[254,-984]}},"53c24e42-9211-4aa8-9cb8-1af541fbbb80":{"position":{"vector":[-36,-587]}},"53bbea1e-6207-4a3e-8762-0c8d969a6bf9":{"position":{"vector":[251,-1293]}},"26337e61-791f-46d9-89f8-dc5e9e5f2701":{"position":{"vector":[251,-1293]}},"5bbc2a4a-3a2c-4eb9-b9af-f63cf8585838":{"position":{"vector":[-40,-659]}},"61e38332-cea2-4b5d-b5c7-4b3363304b70":{"position":{"vector":[251,-1515]}},"bd033f42-a75f-45e2-9447-a609b73535e9":{"position":{"vector":[251,-1515]}},"50d9cab0-a693-4980-aba8-f16308763c71":{"position":{"vector":[251,-1515]}},"b5d219da-2459-4793-afae-5e9ebdeadc81":{"position":{"vector":[251,-1515]}},"5603c099-0143-43fa-81c0-13ff4d7030c8":{"position":{"vector":[-36,-731]},"visualization":{"show":true,"width":733.5625,"height":360.625}},"89868e70-a07c-440f-870d-5de4d249c79f":{"position":{"vector":[337,-1737]}},"0e9c642f-4dd4-4120-9e87-b52f8a840418":{"position":{"vector":[337,-1737]}}},"widget":{},"import":{},"snapshot":"eJyFVMFuGzcQvesrHuzDWoBCw07cnnxwZacOkDRAZdQHw1iMyFmJNZfckNzI21N/o7/XLymGK9lyG6c3kvNm3uO8IZsYWiwyeUPRqJ8oMWzbhZhBzk2aF9EbWrrvhC8p0/K7BS5uF68Hfw5h5bi+6OzrmE9Wx5BCk1+HLHzYNI4e/u8e1O8DtssnyNUjtZ3j9J/Abzb15OwflG3wk8nhIQ4xj0zZ+hUI760nry05zF1IjDk5lkS8wVle4zbEBwFe0oDQ4Ir0Gp+Cz+vJZALgZs3oYviddQbZNiEHaCnOIKQhZW7RhAjSuo+U2Q0wnDm21kvVvObCstmymJGFhaUVlhkogVOmpbNpzQbLAaGPmL//LBHJD3FFfnu9v//8K2Hx8QKGyTjrWeFmbROoz6GlzAaanO5dAWNjnUPKkakVLHS02WpyWPbJek4JoeNYsGkmvY/hK4ObxmrLXg8zkDdgn/rI0KHtnCWvGRub10Va4ixqVGlT5NS70vQcghvJpaI1DO0o2jyAZFgSDHcUc8s+pxnYy+X9CkvOmSM6R740T8gjp9BHzTISQRepatKS9TgXe/ClD/kE5yIy1FujlKFMx6j01mml09eqoBvrWNDyLlRkMtv8I6Uu2dnWSgfXTIZjOlfqmlJ9Pe6mJV9sKgVKIdVRTIy76pIyVzNU89B25AdcB2cNDam6h5I3yKg+HZvjYRhVHB7KEBaXWCaiDk29YX7AG5zAJhk/Q8MMP8pm0cum5JEfhHsUoaT3R/zYRVR7NY7uhO9+Wk1xsHd8sCP+lVvx+Jb5gb1Ju7qnOC/lVWOdeLBfspL2XH3pydWfY/1RxuZsbIcOrm/9nqYV5290YUfybiQ5VbGIqMf0hLsXbN/s47/k7wIov8juRe943o48754uU/yRW3xI9Qf/JFupsdz0yZXdwy4fAOYFhz6xKW98FUPfyWBaX6bf82NGytztiM9G4rejN0otrPxY9ZWYdKTUL9TyVsy0jJyQKVXIplMclMXB86BtTTlTZEwdw6b2fbvkiIPtXzXicTIKq5fD+V1Vzqp7hGg4lqOXxFDqImn2xvrV9H4n/Iedhad7PXvmeJ4Acf4fd7w7qg=="}}