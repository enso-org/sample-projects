from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Visualization

## ![image](ea.png)
   
   # Project Goal
   
   - Rank overall sales performance for the team over the past 3 years. 
   - The order information lives in the accounting system 
   - Account Executive information lives in the CRM
   - Common ID is the EIN, which has some formatting issues.
   
   # Enso Benefits
   
   - Save an average of **7 hours per week** by not repeating work just because the data changes
   - Runs locally on Windows, Mac & Linux, as well as in a browser with 100% compabibility.
   - All of the configuration is visible on each component, making it easy to identify mistakes, and ensuring auditability of the workflows.
   - Data processing is pushed down into the database engine when connected to database sources, using the same components that you use for files.
   - Hundreds of components avaiable, ensuring you will have the capabilties to solve any data challenge.
   
   # Next Steps
   
   - Download Enso Community Edition from [https://ensoanalytics.com](https://ensoanalytics.com)
   - Join the Enso Community at [https://community.ensoanalytics.com](https://community.ensoanalytics.com)
   - Spread the word!
main =
    ## Type the path to your the Excel file on your local machine
    text1 = "/Users/ensouser/Documents/finance data/Invoice_CRM_Data_June 2024.xlsx"
    ## Type the path the the Excel file on your local machine
    text2 = "/Users/ensouser/Documents/finance data/Invoice_CRM_Data_July 2024.xlsx"
    ## June Data packaged as part of the project
    quot1 = enso_project.data/ 'Invoice_CRM_Data_June 2024.xlsx'
    ## Optionally choose the file from your local path by clicing on "path" below 
    node1 = Data.read quot1 Auto_Detect
    node2 = node1.read 'Invoice'
    node3 = node1.read 'CRM'
    table1 = node2.text_cleanse ['EIN'] [..Symbols]
    any1 = table1.set (expr 'text_left([EIN],2) + \'-\' + text_right([EIN],7)') 'EIN'
    table2 = any1.parse ['invoice_date'] ..Date 'dd MMMM, yyyy'
    any2 = table2.set (..Simple_Expr (..Name 'invoice_date') (..Date ..Year)) 'Year'
    any3 = any2.distinct on_problems=..Ignore
    table3 = node3.text_cleanse ['EIN'] [..Symbols]
    any4 = table3.set (expr 'text_left([EIN],2) + \'-\' + text_right([EIN],7)') 'EIN'
    table4 = any3.join any4 ..Inner [(..Equals 'EIN')]
    any5 = table4.cross_tab ['account_owner'] 'Year' (..Sum 'invoice_amount')
    any6 = any5.sort [(..Name '2024' ..Descending)]
    any7 = any6.format [(..By_Type ..Float)] '#,##0.00'
    ## Choose a path below to write the information in the component above to an Excel Sheet called 2024-10 
    any10 = any7.write '/Users/ensouser/Documents/Demo/Sales Performance Output.xlsx' (..Workbook default_sheet='2024-10') ..Backup
    ## July Data packaged as part of the project
    quot2 = enso_project.data/ 'Invoice_CRM_Data_July 2024.xlsx'



#### METADATA ####
[[{"index":{"value":1495},"size":{"value":72}},"f6d01bd8-3566-4f5e-9940-a93dc588e7fe"],[{"index":{"value":1642},"size":{"value":72}},"1e7a2d80-0feb-4632-8706-7fd6d2f84271"],[{"index":{"value":1776},"size":{"value":18}},"e31114e7-e584-450c-952e-bbf773f791d2"],[{"index":{"value":1776},"size":{"value":52}},"a27cac6a-669f-4d82-b4ff-100ba52e4203"],[{"index":{"value":1924},"size":{"value":15}},"0a68d440-a0b5-4d6e-ad08-4fb7532a69ce"],[{"index":{"value":1924},"size":{"value":27}},"235c06eb-7293-4675-8d18-1396cc74af6f"],[{"index":{"value":1964},"size":{"value":20}},"71560ce4-47ce-4d5f-9c65-cd338e3becc2"],[{"index":{"value":1997},"size":{"value":16}},"3f4b524f-f08d-4508-91f5-c9dfcfdcf326"],[{"index":{"value":2027},"size":{"value":18}},"9d6c459a-c2c2-42dc-ba66-6054834b04d1"],[{"index":{"value":2027},"size":{"value":26}},"78a8a3ef-b447-40e3-874e-ac9fbc63f01f"],[{"index":{"value":2027},"size":{"value":38}},"01372e20-ea45-43d3-9bea-9c5e64c86ab8"],[{"index":{"value":2077},"size":{"value":10}},"40620ee1-9313-4e6c-ad9a-0e76b9aed728"],[{"index":{"value":2077},"size":{"value":68}},"d0eb641d-185a-4494-8c58-3ec6fa441d08"],[{"index":{"value":2077},"size":{"value":74}},"9028d841-3ba4-4053-9e63-3a4c070d72fa"],[{"index":{"value":2165},"size":{"value":10}},"862d0e1a-1cde-45e0-b5d7-2941f0b76795"],[{"index":{"value":2165},"size":{"value":27}},"64d757cc-e159-4241-b7af-e4d195ec4f8c"],[{"index":{"value":2165},"size":{"value":34}},"6788bc65-cef2-43bb-986e-803ae9310b7d"],[{"index":{"value":2165},"size":{"value":50}},"ac101af3-063a-47d1-a252-61d9d7eb0d2f"],[{"index":{"value":2227},"size":{"value":10}},"d10f6ea6-c042-4ec7-bff1-9d578b104621"],[{"index":{"value":2227},"size":{"value":66}},"4446457b-94af-42bd-ae4c-2fa020491b00"],[{"index":{"value":2227},"size":{"value":73}},"a1f38723-34c0-4f3d-b40a-6f35653c9bb3"],[{"index":{"value":2312},"size":{"value":13}},"a794d437-197d-4928-a258-036d78a68e77"],[{"index":{"value":2312},"size":{"value":34}},"f7e98ff9-c11e-4754-a125-21282765a7ba"],[{"index":{"value":2360},"size":{"value":38}},"3d9e288b-a837-4fe9-8151-00267ba5cd6b"],[{"index":{"value":2410},"size":{"value":74}},"f9a338dc-15f0-4274-9ea3-bbd168cfdb03"],[{"index":{"value":2498},"size":{"value":9}},"bdaa0042-93ba-41b9-b55c-6dca20188d42"],[{"index":{"value":2498},"size":{"value":14}},"c64218cc-371d-4966-9c35-193362232836"],[{"index":{"value":2498},"size":{"value":22}},"b7a59daf-d2c8-48cb-aaae-bde8b2eeade1"],[{"index":{"value":2498},"size":{"value":41}},"53d77b34-d71b-48f1-b861-3f18dfdd3d27"],[{"index":{"value":2551},"size":{"value":16}},"92a346f4-d04e-4a53-a669-d0c4f81bf452"],[{"index":{"value":2551},"size":{"value":34}},"e813c5fa-aa4f-4a06-9aa6-9a5760cae47c"],[{"index":{"value":2551},"size":{"value":41}},"3a5a5a46-8a2e-4169-b3cc-fca88346b5e4"],[{"index":{"value":2551},"size":{"value":66}},"f1bd7270-4511-4d17-bc4f-85ad07b203b3"],[{"index":{"value":2629},"size":{"value":9}},"f7d3bfe7-b250-4eb4-a28c-0020259840ed"],[{"index":{"value":2629},"size":{"value":40}},"432cf088-d60f-4d4d-ae56-bb1535f40830"],[{"index":{"value":2681},"size":{"value":11}},"775d1305-355c-46e2-9f66-032a87877a3d"],[{"index":{"value":2681},"size":{"value":33}},"e30d233d-7cd7-4613-83ea-99088ca9180e"],[{"index":{"value":2681},"size":{"value":44}},"90a4ca5f-3fb8-459f-afca-f16f0212f9c6"],[{"index":{"value":2847},"size":{"value":119}},"9757a3a1-2956-40ff-8fd3-633779e27998"],[{"index":{"value":3028},"size":{"value":18}},"121cbb9d-473a-47ad-b03c-ffa9ce452548"],[{"index":{"value":3028},"size":{"value":52}},"e821e2a0-c815-4991-aee2-e9ac2638d5e2"]]
{"ide":{"node":{"f6d01bd8-3566-4f5e-9940-a93dc588e7fe":{"position":{"vector":[433,-816]}},"1e7a2d80-0feb-4632-8706-7fd6d2f84271":{"position":{"vector":[1100,-816]}},"a27cac6a-669f-4d82-b4ff-100ba52e4203":{"position":{"vector":[375,-1017]}},"e31114e7-e584-450c-952e-bbf773f791d2":{"position":{"vector":[817,-838]}},"235c06eb-7293-4675-8d18-1396cc74af6f":{"position":{"vector":[453,-1189]},"visualization":{"show":false,"project":{"project":"Builtin"},"name":"Table"}},"0a68d440-a0b5-4d6e-ad08-4fb7532a69ce":{"position":{"vector":[453,-1215]},"visualization":{"show":true,"project":{"project":"Builtin"},"name":"Table"}},"71560ce4-47ce-4d5f-9c65-cd338e3becc2":{"position":{"vector":[453,-1261]},"visualization":{"show":false,"width":483.9488819896112}},"3f4b524f-f08d-4508-91f5-c9dfcfdcf326":{"position":{"vector":[1036,-1458]}},"01372e20-ea45-43d3-9bea-9c5e64c86ab8":{"position":{"vector":[453,-1359]}},"78a8a3ef-b447-40e3-874e-ac9fbc63f01f":{"position":{"vector":[453,-1731]}},"9d6c459a-c2c2-42dc-ba66-6054834b04d1":{"position":{"vector":[453,-1731]}},"9028d841-3ba4-4053-9e63-3a4c070d72fa":{"position":{"vector":[453,-1431]}},"d0eb641d-185a-4494-8c58-3ec6fa441d08":{"position":{"vector":[453,-1989]}},"40620ee1-9313-4e6c-ad9a-0e76b9aed728":{"position":{"vector":[453,-1989]}},"ac101af3-063a-47d1-a252-61d9d7eb0d2f":{"position":{"vector":[453,-1503]}},"6788bc65-cef2-43bb-986e-803ae9310b7d":{"position":{"vector":[453,-1875]}},"64d757cc-e159-4241-b7af-e4d195ec4f8c":{"position":{"vector":[453,-1875]}},"862d0e1a-1cde-45e0-b5d7-2941f0b76795":{"position":{"vector":[453,-1875]}},"a1f38723-34c0-4f3d-b40a-6f35653c9bb3":{"position":{"vector":[453,-1575]}},"4446457b-94af-42bd-ae4c-2fa020491b00":{"position":{"vector":[453,-1947]}},"d10f6ea6-c042-4ec7-bff1-9d578b104621":{"position":{"vector":[453,-1947]}},"f7e98ff9-c11e-4754-a125-21282765a7ba":{"position":{"vector":[453,-1647]}},"a794d437-197d-4928-a258-036d78a68e77":{"position":{"vector":[453,-2037]}},"3d9e288b-a837-4fe9-8151-00267ba5cd6b":{"position":{"vector":[1036,-1575]}},"f9a338dc-15f0-4274-9ea3-bbd168cfdb03":{"position":{"vector":[1036,-1685]}},"53d77b34-d71b-48f1-b861-3f18dfdd3d27":{"position":{"vector":[453,-1737]},"visualization":{"show":true,"width":1489.9043496938855,"height":108.51492987984304,"project":{"project":"Builtin"},"name":"Table"}},"b7a59daf-d2c8-48cb-aaae-bde8b2eeade1":{"position":{"vector":[757,-2182]}},"c64218cc-371d-4966-9c35-193362232836":{"position":{"vector":[757,-2182]}},"bdaa0042-93ba-41b9-b55c-6dca20188d42":{"position":{"vector":[757,-2182]}},"f1bd7270-4511-4d17-bc4f-85ad07b203b3":{"position":{"vector":[453,-1953]}},"3a5a5a46-8a2e-4169-b3cc-fca88346b5e4":{"position":{"vector":[761,-2251]}},"e813c5fa-aa4f-4a06-9aa6-9a5760cae47c":{"position":{"vector":[761,-2251]}},"92a346f4-d04e-4a53-a669-d0c4f81bf452":{"position":{"vector":[761,-2251]}},"432cf088-d60f-4d4d-ae56-bb1535f40830":{"position":{"vector":[453,-2025]}},"f7d3bfe7-b250-4eb4-a28c-0020259840ed":{"position":{"vector":[761,-2509]}},"90a4ca5f-3fb8-459f-afca-f16f0212f9c6":{"position":{"vector":[453,-2097]},"visualization":{"show":true,"width":879.59765625,"height":337.29296875,"project":{"project":"Builtin"},"name":"Table"}},"e30d233d-7cd7-4613-83ea-99088ca9180e":{"position":{"vector":[761,-2581]}},"775d1305-355c-46e2-9f66-032a87877a3d":{"position":{"vector":[761,-2581]}},"9757a3a1-2956-40ff-8fd3-633779e27998":{"position":{"vector":[453,-2564]}},"e821e2a0-c815-4991-aee2-e9ac2638d5e2":{"position":{"vector":[1040,-1017]}},"121cbb9d-473a-47ad-b03c-ffa9ce452548":{"position":{"vector":[1194,-838]}}},"widget":{},"snapshot":"ZnJvbSBTdGFuZGFyZC5CYXNlIGltcG9ydCBhbGwKZnJvbSBTdGFuZGFyZC5UYWJsZSBpbXBvcnQgYWxsCmZyb20gU3RhbmRhcmQuRGF0YWJhc2UgaW1wb3J0IGFsbApmcm9tIFN0YW5kYXJkLkFXUyBpbXBvcnQgYWxsCmZyb20gU3RhbmRhcmQuR29vZ2xlX0FwaSBpbXBvcnQgYWxsCmZyb20gU3RhbmRhcmQuU25vd2ZsYWtlIGltcG9ydCBhbGwKZnJvbSBTdGFuZGFyZC5UYWJsZWF1IGltcG9ydCBhbGwKaW1wb3J0IFN0YW5kYXJkLlZpc3VhbGl6YXRpb24KCiMjICFbaW1hZ2VdKGVhLnBuZykKICAgCiAgICMgUHJvamVjdCBHb2FsCiAgIAogICAtIFJhbmsgb3ZlcmFsbCBzYWxlcyBwZXJmb3JtYW5jZSBmb3IgdGhlIHRlYW0gb3ZlciB0aGUgcGFzdCAzIHllYXJzLiAKICAgLSBUaGUgb3JkZXIgaW5mb3JtYXRpb24gbGl2ZXMgaW4gdGhlIGFjY291bnRpbmcgc3lzdGVtIAogICAtIEFjY291bnQgRXhlY3V0aXZlIGluZm9ybWF0aW9uIGxpdmVzIGluIHRoZSBDUk0KICAgLSBDb21tb24gSUQgaXMgdGhlIEVJTiwgd2hpY2ggaGFzIHNvbWUgZm9ybWF0dGluZyBpc3N1ZXMuCiAgIAogICAjIEVuc28gQmVuZWZpdHMKICAgCiAgIC0gU2F2ZSBhbiBhdmVyYWdlIG9mICoqNyBob3VycyBwZXIgd2VlayoqIGJ5IG5vdCByZXBlYXRpbmcgd29yayBqdXN0IGJlY2F1c2UgdGhlIGRhdGEgY2hhbmdlcwogICAtIFJ1bnMgbG9jYWxseSBvbiBXaW5kb3dzLCBNYWMgJiBMaW51eCwgYXMgd2VsbCBhcyBpbiBhIGJyb3dzZXIgd2l0aCAxMDAlIGNvbXBhYmliaWxpdHkuCiAgIC0gQWxsIG9mIHRoZSBjb25maWd1cmF0aW9uIGlzIHZpc2libGUgb24gZWFjaCBjb21wb25lbnQsIG1ha2luZyBpdCBlYXN5IHRvIGlkZW50aWZ5IG1pc3Rha2VzLCBhbmQgZW5zdXJpbmcgYXVkaXRhYmlsaXR5IG9mIHRoZSB3b3JrZmxvd3MuCiAgIC0gRGF0YSBwcm9jZXNzaW5nIGlzIHB1c2hlZCBkb3duIGludG8gdGhlIGRhdGFiYXNlIGVuZ2luZSB3aGVuIGNvbm5lY3RlZCB0byBkYXRhYmFzZSBzb3VyY2VzLCB1c2luZyB0aGUgc2FtZSBjb21wb25lbnRzIHRoYXQgeW91IHVzZSBmb3IgZmlsZXMuCiAgIC0gSHVuZHJlZHMgb2YgY29tcG9uZW50cyBhdmFpYWJsZSwgZW5zdXJpbmcgeW91IHdpbGwgaGF2ZSB0aGUgY2FwYWJpbHRpZXMgdG8gc29sdmUgYW55IGRhdGEgY2hhbGxlbmdlLgogICAKICAgIyBOZXh0IFN0ZXBzCiAgIAogICAtIERvd25sb2FkIEVuc28gQ29tbXVuaXR5IEVkaXRpb24gZnJvbSBbaHR0cHM6Ly9lbnNvYW5hbHl0aWNzLmNvbV0oaHR0cHM6Ly9lbnNvYW5hbHl0aWNzLmNvbSkKICAgLSBKb2luIHRoZSBFbnNvIENvbW11bml0eSBhdCBbaHR0cHM6Ly9jb21tdW5pdHkuZW5zb2FuYWx5dGljcy5jb21dKGh0dHBzOi8vY29tbXVuaXR5LmVuc29hbmFseXRpY3MuY29tKQogICAtIFNwcmVhZCB0aGUgd29yZCEKbWFpbiA9CiAgICAjIyBUeXBlIHRoZSBwYXRoIHRvIHlvdXIgdGhlIEV4Y2VsIGZpbGUgb24geW91ciBsb2NhbCBtYWNoaW5lCiAgICB0ZXh0MSA9ICIvVXNlcnMvZW5zb3VzZXIvRG9jdW1lbnRzL2ZpbmFuY2UgZGF0YS9JbnZvaWNlX0NSTV9EYXRhX0p1bmUgMjAyNC54bHN4IgogICAgIyMgVHlwZSB0aGUgcGF0aCB0aGUgdGhlIEV4Y2VsIGZpbGUgb24geW91ciBsb2NhbCBtYWNoaW5lCiAgICB0ZXh0MiA9ICIvVXNlcnMvZW5zb3VzZXIvRG9jdW1lbnRzL2ZpbmFuY2UgZGF0YS9JbnZvaWNlX0NSTV9EYXRhX0p1bHkgMjAyNC54bHN4IgogICAgIyMgSnVuZSBEYXRhIHBhY2thZ2VkIGFzIHBhcnQgb2YgdGhlIHByb2plY3QKICAgIHF1b3QxID0gZW5zb19wcm9qZWN0LmRhdGEvICdJbnZvaWNlX0NSTV9EYXRhX0p1bmUgMjAyNC54bHN4JwogICAgIyMgT3B0aW9uYWxseSBjaG9vc2UgdGhlIGZpbGUgZnJvbSB5b3VyIGxvY2FsIHBhdGggYnkgY2xpY2luZyBvbiAicGF0aCIgYmVsb3cgCiAgICBub2RlMSA9IERhdGEucmVhZCBxdW90MSBBdXRvX0RldGVjdAogICAgbm9kZTIgPSBub2RlMS5yZWFkICdJbnZvaWNlJwogICAgbm9kZTMgPSBub2RlMS5yZWFkICdDUk0nCiAgICB0YWJsZTEgPSBub2RlMi50ZXh0X2NsZWFuc2UgWydFSU4nXSBbLi5TeW1ib2xzXQogICAgYW55MSA9IHRhYmxlMS5zZXQgKGV4cHIgJ3RleHRfbGVmdChbRUlOXSwyKSArIFwnLVwnICsgdGV4dF9yaWdodChbRUlOXSw3KScpICdFSU4nCiAgICB0YWJsZTIgPSBhbnkxLnBhcnNlIFsnaW52b2ljZV9kYXRlJ10gLi5EYXRlICdkZCBNTU1NLCB5eXl5JwogICAgYW55MiA9IHRhYmxlMi5zZXQgKC4uU2ltcGxlX0V4cHIgKC4uTmFtZSAnaW52b2ljZV9kYXRlJykgKC4uRGF0ZSAuLlllYXIpKSAnWWVhcicKICAgIGFueTMgPSBhbnkyLmRpc3RpbmN0IG9uX3Byb2JsZW1zPS4uSWdub3JlCiAgICB0YWJsZTMgPSBub2RlMy50ZXh0X2NsZWFuc2UgWydFSU4nXSBbLi5TeW1ib2xzXQogICAgYW55NCA9IHRhYmxlMy5zZXQgKGV4cHIgJ3RleHRfbGVmdChbRUlOXSwyKSArIFwnLVwnICsgdGV4dF9yaWdodChbRUlOXSw3KScpICdFSU4nCiAgICB0YWJsZTQgPSBhbnkzLmpvaW4gYW55NCAuLklubmVyIFsoLi5FcXVhbHMgJ0VJTicpXQogICAgYW55NSA9IHRhYmxlNC5jcm9zc190YWIgWydhY2NvdW50X293bmVyJ10gJ1llYXInICguLlN1bSAnaW52b2ljZV9hbW91bnQnKQogICAgYW55NiA9IGFueTUuc29ydCBbKC4uTmFtZSAnMjAyNCcgLi5EZXNjZW5kaW5nKV0KICAgIGFueTcgPSBhbnk2LmZvcm1hdCBbKC4uQnlfVHlwZSAuLkZsb2F0KV0gJyMsIyMwLjAwJwogICAgIyMgQ2hvb3NlIGEgcGF0aCBiZWxvdyB0byB3cml0ZSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIGNvbXBvbmVudCBhYm92ZSB0byBhbiBFeGNlbCBTaGVldCBjYWxsZWQgMjAyNC0xMCAKICAgIGFueTEwID0gYW55Ny53cml0ZSAnL1VzZXJzL2Vuc291c2VyL0RvY3VtZW50cy9EZW1vL1NhbGVzIFBlcmZvcm1hbmNlIE91dHB1dC54bHN4JyAoLi5Xb3JrYm9vayBkZWZhdWx0X3NoZWV0PScyMDI0LTEwJykgLi5CYWNrdXAKICAgICMjIEp1bHkgRGF0YSBwYWNrYWdlZCBhcyBwYXJ0IG9mIHRoZSBwcm9qZWN0CiAgICBxdW90MiA9IGVuc29fcHJvamVjdC5kYXRhLyAnSW52b2ljZV9DUk1fRGF0YV9KdWx5IDIwMjQueGxzeCcK"}}