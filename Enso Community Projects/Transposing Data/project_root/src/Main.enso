from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Microsoft import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Examples
import Standard.Visualization

## # Transpose



   Enso Analytics `transpose` component reshapes wide data (data with lots of columns) and reshapes it into a tall and narrow dataset.




   ![Image](/images/image_1.png)


   ## Transpose Example 1


   In the first example on the left, our goal was to take each of the months of the year and put them in a single column. The ID, Product, Category and Channel columns stay as they are, but now have their values repeated 12 times (one per month). A new field is created for the Amount for each month.

   ## Transpose Example 2


   In the second example on the left, we filter out columns that we do not want to transpose into name/value pairs. 


   ## Unpivoting data with cross_tab


   Enso's `cross_tab` component performs the inverse operation of a `transpose` component, reshaping tall and narrow data and making it short and wide.



   The 'group_by' argument takes the 'key_coumns' from the transpose.



   Columns and rows are not necessarily going to come back in the order that went in above, so we sort the columns and the rows to get back to our orignal data.
main =
    ## Input data
    node2 = Table.input [['ID', ['1001', '1002', '1003', '1004', '1005', '1006', '1007', '1008', '1009', '1010', '1011', '1012', '1013', '1014', '1015', '1016', '1017', '1018', '1019', '1020', '1021', '1022', '1023', '1024', '1025']], ['Product', ['Toaster', 'Microwave', 'Vacuum Cleaner', 'Dish Soap', 'Laundry Detergent', 'Shampoo', 'Conditioner', 'Laptop', 'Smartphone', 'Bluetooth Speaker', 'T-Shirt', 'Jeans', 'Jacket', 'Running Shoes', 'Sandals', 'Notebook', 'Pen Pack', 'Yoga Mat', 'Dumbbells', 'Blender', 'Pillow', 'Curtains', 'Board Game', 'Stuffed Animal', 'Bicycle']], ['Category', ['Kitchen Appliances', 'Kitchen Appliances', 'Home Appliances', 'Cleaning Supplies', 'Cleaning Supplies', 'Personal Care', 'Personal Care', 'Electronics', 'Electronics', 'Electronics', 'Clothing', 'Clothing', 'Clothing', 'Footwear', 'Footwear', 'Stationery', 'Stationery', 'Fitness', 'Fitness', 'Kitchen Appliances', 'Home Decor', 'Home Decor', 'Toys & Games', 'Toys & Games', 'Outdoor Recreation']], ['Channel', ['Online', 'Online', 'Online', 'Online', 'In-Store', 'Online', 'Online', 'In-Store', 'Online', 'In-Store', 'In-Store', 'Online', 'Online', 'In-Store', 'In-Store', 'Online', 'In-Store', 'Online', 'Online', 'In-Store', 'Online', 'Online', 'In-Store', 'In-Store', 'Online']], ['January', ['15453', '197172', '127939', '82924', '130958', '96162', '190747', '137807', '95698', '172031', '143538', '74212', '52177', '185374', '101767', '21033', '52716', '93067', '103071', '84174', '36077', '76002', '169369', '27153', '60514']], ['February', ['96479', '25213', '163324', '165685', '26073', '163506', '196847', '105935', '145150', '40376', '148125', '106845', '193861', '81005', '104280', '109229', '26102', '119277', '100805', '29627', '63834', '152366', '173624', '154592', '83699']], ['March', ['113466', '64093', '56580', '23205', '128393', '33885', '160629', '57027', '134940', '15969', '101267', '43491', '83903', '170862', '161995', '43830', '121891', '149165', '88152', '84210', '59060', '181877', '58518', '129578', '50844']], ['April', ['201696', '159094', '47662', '51408', '77291', '198952', '174341', '118450', '86238', '46212', '75296', '44272', '128872', '23915', '99665', '91922', '157580', '153364', '143229', '200612', '43261', '96058', '127530', '77246', '31382']], ['May', ['42604', '28655', '79097', '41511', '50407', '44550', '179468', '123080', '103248', '39846', '13713', '107955', '193856', '114866', '144253', '20599', '122634', '127794', '156512', '19394', '134921', '202328', '128314', '178416', '161032']], ['June', ['182423', '37471', '107514', '43188', '172849', '148889', '73579', '191665', '192300', '138023', '29020', '81457', '60559', '168725', '153791', '72327', '200494', '50157', '62130', '60384', '20502', '14045', '81633', '155350', '26309']], ['July', ['135101', '34344', '196379', '106788', '119251', '186896', '130608', '57398', '165125', '194676', '184793', '56271', '132930', '22394', '181990', '80715', '112394', '59677', '26845', '98459', '162324', '133649', '85915', '101854', '144723']], ['August', ['199931', '157895', '95627', '134113', '19710', '122346', '142027', '179427', '140910', '170821', '19196', '187182', '88945', '72743', '109208', '172403', '140443', '122068', '184074', '147067', '123048', '159751', '190815', '92386', '187833']], ['September', ['100570', '92592', '75127', '195632', '70424', '163881', '52921', '75386', '63122', '147463', '187720', '98921', '107845', '60006', '74885', '93854', '14148', '69721', '145586', '50688', '144642', '73721', '73478', '202489', '93851']], ['October', ['68887', '45522', '149905', '137832', '119697', '132456', '101100', '83067', '29631', '159107', '150134', '26991', '198073', '191815', '168626', '137135', '83650', '186686', '165756', '52379', '194946', '146335', '174934', '78906', '91142']], ['November', ['76181', '28554', '17212', '181160', '164817', '78672', '56522', '180970', '202073', '79449', '101254', '143477', '101373', '59551', '43657', '142477', '74682', '66542', '172004', '46396', '77563', '179635', '38155', '13280', '98057']], ['December', ['20401', '20946', '47736', '147641', '74726', '100150', '39847', '138045', '138055', '48112', '155326', '189564', '157184', '176167', '112711', '97584', '143930', '177904', '183564', '191645', '51100', '49343', '91877', '134559', '175359']]]
    ## Transpose Example 2
    any2 = node2.select_columns ['Product', 'Category', 'Channel']
    any3 = any2.transpose ['Product']
    ## Transpose Example 1
    any1 = node2.transpose ['ID', 'Product', 'Category', 'Channel'] "Month" "Amount"
    any7 = any1.set (..Simple_Expr (..Name 'Amount') (..Math (..Multiply 1.1))) "Amount"
    ## Unpivoting data with cross_tab
    any4 = any7.cross_tab ['ID', 'Product', 'Category', 'Channel'] 'Month' (..First 'Amount')
    any5 = any4.reorder_columns ['ID', 'Product', 'Category', 'Channel', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
    any6 = any5.sort [(..Name 'ID' ..Ascending)]



#### METADATA ####
[[{"index":{"value":1453},"size":{"value":4296}},"24516091-5548-4232-9692-6b77cda6d5c2"],[{"index":{"value":5788},"size":{"value":20}},"8ee6b697-0ace-4e29-9c53-b58067bf9cba"],[{"index":{"value":5788},"size":{"value":55}},"d4bb2a77-a39b-4a65-8ef7-36eca2a22727"],[{"index":{"value":5855},"size":{"value":14}},"bdbbb575-5ff0-4242-bf3b-e5d4fd75ec31"],[{"index":{"value":5855},"size":{"value":26}},"ae7d4b66-a291-465b-bab6-2540955c1c4b"],[{"index":{"value":5920},"size":{"value":15}},"b51cd7fc-2b10-41aa-9409-dac5a713a7a4"],[{"index":{"value":5920},"size":{"value":56}},"74d8ae41-7632-4115-bc05-c0663d7e4da7"],[{"index":{"value":5920},"size":{"value":64}},"4088b4cf-0dc8-403e-8d0f-3ccaed66bfd0"],[{"index":{"value":5920},"size":{"value":73}},"e93cca79-1668-4163-9187-d30997be338d"],[{"index":{"value":6005},"size":{"value":8}},"b84f670c-3ade-4ef5-84fe-9ac176fcd45d"],[{"index":{"value":6005},"size":{"value":68}},"5e419067-3fc7-4a57-a0b6-9259f2887228"],[{"index":{"value":6005},"size":{"value":77}},"7088c7e5-ad61-4a1f-bf35-90fd06f6819c"],[{"index":{"value":6132},"size":{"value":14}},"f54ddce9-a024-4378-af1f-34697e3a1fcf"],[{"index":{"value":6132},"size":{"value":55}},"811a8c00-58a6-4d50-a14a-4e75f703e69f"],[{"index":{"value":6132},"size":{"value":63}},"e70cf232-3f19-47b4-8137-96224f40fec6"],[{"index":{"value":6132},"size":{"value":82}},"7a00be08-de62-44dc-a88f-8cd92b83bb08"],[{"index":{"value":6226},"size":{"value":20}},"f41e5212-aaca-4a96-949d-50c46de8d4ea"],[{"index":{"value":6226},"size":{"value":183}},"1381948a-89a5-4908-949b-d5248c3c34b0"],[{"index":{"value":6421},"size":{"value":9}},"2f214482-8ffa-421b-a282-9538f98ce165"],[{"index":{"value":6421},"size":{"value":37}},"c5824612-f487-49f9-88b9-124e35e27f4a"]]
{"ide":{"node":{"24516091-5548-4232-9692-6b77cda6d5c2":{"position":{"vector":[-878,377]}},"d4bb2a77-a39b-4a65-8ef7-36eca2a22727":{"position":{"vector":[269,-38]}},"8ee6b697-0ace-4e29-9c53-b58067bf9cba":{"position":{"vector":[269,-38]}},"ae7d4b66-a291-465b-bab6-2540955c1c4b":{"position":{"vector":[269,-94]},"visualization":{"show":true,"width":659.87890625,"height":318.7734375}},"bdbbb575-5ff0-4242-bf3b-e5d4fd75ec31":{"position":{"vector":[318,-146]}},"e93cca79-1668-4163-9187-d30997be338d":{"position":{"vector":[-860,-26]},"visualization":{"show":true,"width":947.01171875,"height":386.98046875}},"4088b4cf-0dc8-403e-8d0f-3ccaed66bfd0":{"position":{"vector":[-768,82]},"visualization":{"show":true}},"74d8ae41-7632-4115-bc05-c0663d7e4da7":{"position":{"vector":[-768,82]}},"b51cd7fc-2b10-41aa-9409-dac5a713a7a4":{"position":{"vector":[-768,82]}},"7088c7e5-ad61-4a1f-bf35-90fd06f6819c":{"position":{"vector":[-860,-485]},"visualization":{"show":true,"width":1030.09375,"height":227.80208333333334}},"5e419067-3fc7-4a57-a0b6-9259f2887228":{"position":{"vector":[-738,-485]}},"b84f670c-3ade-4ef5-84fe-9ac176fcd45d":{"position":{"vector":[-748,-493]}},"7a00be08-de62-44dc-a88f-8cd92b83bb08":{"position":{"vector":[-860,-822]},"visualization":{"show":false,"width":1557.671875}},"e70cf232-3f19-47b4-8137-96224f40fec6":{"position":{"vector":[-860,-540]},"visualization":{"show":true,"width":981.17578125}},"811a8c00-58a6-4d50-a14a-4e75f703e69f":{"position":{"vector":[-860,-540]}},"f54ddce9-a024-4378-af1f-34697e3a1fcf":{"position":{"vector":[-860,-540]}},"1381948a-89a5-4908-949b-d5248c3c34b0":{"position":{"vector":[-860,-894]}},"f41e5212-aaca-4a96-949d-50c46de8d4ea":{"position":{"vector":[-860,-785]}},"c5824612-f487-49f9-88b9-124e35e27f4a":{"position":{"vector":[-860,-966]},"visualization":{"show":true,"width":2361.6796875,"height":239.50390625}},"2f214482-8ffa-421b-a282-9538f98ce165":{"position":{"vector":[-789,-1017]}}},"widget":{"24516091-5548-4232-9692-6b77cda6d5c2":{"WidgetTableEditor":{"size":{"x":1809.84765625,"y":298.11328125}}}},"snapshot":"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","import":{}}}