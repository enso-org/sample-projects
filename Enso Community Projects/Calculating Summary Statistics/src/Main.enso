from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Microsoft import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Examples
import Standard.Visualization
from Standard.Base.Main import Encoding
from Standard.Table.Main import Table

## ICON group
numeric_stats file1 any7 =
    any2 = file1.aggregate columns=[..Average any7 "Average", ..Median any7 "Median", ..Minimum any7 "Minimum", ..Maximum any7 "Maximum", ..Percentile 0.1 any7 "10th Percentile", ..Percentile 0.25 any7 "25th Percentile", ..Percentile 0.75 column=any7 "75th Percentile", ..Percentile 0.9 column=any7 "90th Percentile", ..Standard_Deviation any7 "Standard Deviation", ..Mode any7 "Mode"] on_problems=..Ignore
    colname = any7
    any1 = any2.set colname "Column"
    any3 = any1.reorder_columns ['Column'] ..Before_Other_Columns
    any3

main =
    quot1 = enso_project.data/ 'happyscore-income.csv'
    file1 = Data.read quot1
    column1 = file1.get 'happyScore'
    column2 = file1.get 'GDP'
    any1 = column1.compute (..Pearson column2)
    column3 = file1.get 'happyScore'
    column4 = file1.get 'GDP'
    vector1 = [Statistic.Count, Statistic.Product, Statistic.Mean,Statistic.Maximum, Statistic.Minimum, Statistic.Standard_Deviation,Statistic.Skew, Statistic.Kurtosis, Statistic.Covariance column4, Statistic.Pearson column4, Statistic.Spearman column4, Statistic.R_Squared column4]
    table1 = column3.compute_bulk vector1
    table2 = file1.column_info
    any5 = table2.cast ['Value Type'] ..Char
    any6 = any5.filter (expr 'contains([Value Type],"Float") or contains([Value Type],"Integer")') ..Is_True
    column5 = any6.get 'Column'
    any9 = Main.numeric_stats file1
    any2 = column5.map any9
    any3 = Table.from_union any2
    any4 = file1.aggregate ['region'] [..Minimum 'happyScore', ..Maximum 'happyScore', ..Median 'happyScore', ..Average 'happyScore', ..Percentile 0.25 'happyScore', ..Standard_Deviation 'happyScore']
    table3 = table2.join any3 ..Left_Outer [(..Equals 'Column' 'Column')]
    any7 = table3.remove_columns ['Right Column']



#### METADATA ####
[[{"index":{"value":425},"size":{"value":5}},"389dbc27-c458-4ef3-ab16-08ed18e0b481"],[{"index":{"value":431},"size":{"value":4}},"6472fd4c-0278-4e16-8229-9398bda2797d"],[{"index":{"value":449},"size":{"value":15}},"3d1edc61-0864-4a14-ab38-a06978052cfd"],[{"index":{"value":449},"size":{"value":374}},"9af5e039-72ca-4d18-bb85-7aae544fb407"],[{"index":{"value":449},"size":{"value":395}},"3c4cc415-840c-458e-867b-267eec5be082"],[{"index":{"value":859},"size":{"value":4}},"5012d62f-4f89-419a-a466-4f8200098896"],[{"index":{"value":875},"size":{"value":8}},"7aa605f2-0c7b-4400-a7ec-1e2460ba1233"],[{"index":{"value":875},"size":{"value":16}},"5bd3f212-f601-4cfd-b4dd-1aa05a65ea3d"],[{"index":{"value":875},"size":{"value":25}},"0429fa0a-1c13-41ef-a2ca-ca5ec06f2a65"],[{"index":{"value":912},"size":{"value":20}},"eff70ffb-7da5-4a5d-9c45-ab62ff026ab3"],[{"index":{"value":912},"size":{"value":31}},"e87ad5e6-41d7-467c-b8b8-02dc5176702a"],[{"index":{"value":912},"size":{"value":54}},"ae587ba5-ec74-4d01-bff2-b3cf8a340c7d"],[{"index":{"value":971},"size":{"value":4}},"c47b6aa6-7abb-4622-8527-1af41d3431a1"],[{"index":{"value":996},"size":{"value":18}},"970afd65-ecbf-4462-86e0-50eb17d8c4bb"],[{"index":{"value":996},"size":{"value":42}},"0632ca7b-3b48-4302-8647-3edf053a8bd9"],[{"index":{"value":1051},"size":{"value":15}},"fcf199e6-d2b1-44b7-be92-a47545d6a593"],[{"index":{"value":1081},"size":{"value":9}},"47119926-e01d-42e5-bf99-49d3a957182d"],[{"index":{"value":1081},"size":{"value":22}},"a41cc5ea-47fb-4554-b4d9-c4e940ed4a44"],[{"index":{"value":1118},"size":{"value":9}},"579ff032-0285-4443-9dc3-ffbf482da61f"],[{"index":{"value":1118},"size":{"value":15}},"a76ea270-2455-4077-879d-45323314808c"],[{"index":{"value":1145},"size":{"value":15}},"cdf30e85-913b-4ace-aeff-45bbf42e5d39"],[{"index":{"value":1145},"size":{"value":35}},"cd191e30-15c4-4fd6-89e5-0267e519d38a"],[{"index":{"value":1195},"size":{"value":22}},"299ecb1d-1c8f-4101-8a96-4b2ae97306a5"],[{"index":{"value":1232},"size":{"value":15}},"e32181ee-79d0-4181-a09d-fc0fee344d1f"],[{"index":{"value":1262},"size":{"value":268}},"d2bbdedf-30e6-4576-b44c-fdae65bbc30e"],[{"index":{"value":1544},"size":{"value":20}},"d8cc6979-2125-45a2-80ba-647458da128a"],[{"index":{"value":1544},"size":{"value":28}},"50d8f24a-9e84-4ca7-bfe6-8c83fc6c59fa"],[{"index":{"value":1586},"size":{"value":17}},"8c936296-c1b7-4b30-9629-40eb41f3756a"],[{"index":{"value":1615},"size":{"value":11}},"a4d1b754-ebe1-409a-9d50-3ad0165bcef5"],[{"index":{"value":1615},"size":{"value":26}},"8d3a9532-6c14-4912-b29f-79d240255583"],[{"index":{"value":1615},"size":{"value":33}},"03dc7bf1-fcb1-4c8d-b7b8-fff267119843"],[{"index":{"value":1660},"size":{"value":11}},"c044904f-e9d9-46f9-abe4-bb1442b689d1"],[{"index":{"value":1660},"size":{"value":87}},"627e5011-9046-4513-bbb0-7ed9a4744dc9"],[{"index":{"value":1660},"size":{"value":97}},"f82b920a-0801-4330-9745-3db57eea5dae"],[{"index":{"value":1772},"size":{"value":8}},"2c5aa2b8-9920-429c-bdb0-8c1ca9619a0f"],[{"index":{"value":1772},"size":{"value":17}},"e3a11915-7834-43b4-ad42-ea363ab82ab2"],[{"index":{"value":1801},"size":{"value":24}},"69dc5492-fe42-4657-b44f-5e256f348eaf"],[{"index":{"value":1837},"size":{"value":11}},"e6764fa3-33ac-464c-8146-92b0fcf574c1"],[{"index":{"value":1837},"size":{"value":16}},"eb75fee5-6f54-4691-93f3-844fd511a2da"],[{"index":{"value":1865},"size":{"value":16}},"e5337399-313d-4156-897d-7033fa0a53c3"],[{"index":{"value":1865},"size":{"value":21}},"e2203002-efe7-4eb4-ac86-08b082859d82"],[{"index":{"value":1898},"size":{"value":15}},"42e9eff0-4f8e-4f43-98e8-247cd00707bf"],[{"index":{"value":1898},"size":{"value":26}},"04ef082a-10b3-4d6b-9f10-a5fd89bd58fe"],[{"index":{"value":1898},"size":{"value":189}},"fcf764d6-8c90-4134-8a3f-a6f53bc29466"],[{"index":{"value":2101},"size":{"value":11}},"edbdf433-8ba3-4787-b3d9-f3442050f10d"],[{"index":{"value":2101},"size":{"value":16}},"f9edd9a0-849e-4e0c-a372-c33e9a5b737b"],[{"index":{"value":2101},"size":{"value":29}},"039f69bd-26c2-4548-a42c-342ffbe6d6b4"],[{"index":{"value":2101},"size":{"value":60}},"8f58cd4f-99ec-4991-a9e0-6ac180387601"],[{"index":{"value":2173},"size":{"value":21}},"39acdb3c-3c92-4ab6-8222-9d310aea572a"],[{"index":{"value":2173},"size":{"value":38}},"564fb8a6-4e6b-47b6-bba4-3819e9b1ac3a"]]
{"ide":{"node":{"389dbc27-c458-4ef3-ab16-08ed18e0b481":{"position":{"vector":[-523,-569]}},"6472fd4c-0278-4e16-8229-9398bda2797d":{"position":{"vector":[-413,-569]}},"3c4cc415-840c-458e-867b-267eec5be082":{"position":{"vector":[-523,-641]},"visualization":{"show":false,"width":2431.251953125}},"9af5e039-72ca-4d18-bb85-7aae544fb407":{"position":{"vector":[-545,60]},"visualization":{"show":true,"width":1379.605735641094}},"3d1edc61-0864-4a14-ab38-a06978052cfd":{"position":{"vector":[-206,167]}},"5012d62f-4f89-419a-a466-4f8200098896":{"position":{"vector":[-223,-756]},"visualization":{"show":false,"width":388.45349066007867}},"0429fa0a-1c13-41ef-a2ca-ca5ec06f2a65":{"position":{"vector":[-360,-950]},"visualization":{"show":false,"width":855.8125}},"5bd3f212-f601-4cfd-b4dd-1aa05a65ea3d":{"position":{"vector":[387,-755]}},"7aa605f2-0c7b-4400-a7ec-1e2460ba1233":{"position":{"vector":[387,-755]}},"ae587ba5-ec74-4d01-bff2-b3cf8a340c7d":{"position":{"vector":[-360,-1048]}},"e87ad5e6-41d7-467c-b8b8-02dc5176702a":{"position":{"vector":[-474,-1175]}},"eff70ffb-7da5-4a5d-9c45-ab62ff026ab3":{"position":{"vector":[-474,-1175]}},"c47b6aa6-7abb-4622-8527-1af41d3431a1":{"position":{"vector":[-360,-1120]}},"0632ca7b-3b48-4302-8647-3edf053a8bd9":{"position":{"vector":[-957,662]}},"970afd65-ecbf-4462-86e0-50eb17d8c4bb":{"position":{"vector":[292,-88]}},"fcf199e6-d2b1-44b7-be92-a47545d6a593":{"position":{"vector":[-957,561]},"visualization":{"show":true,"width":2377.7845918676053,"height":252}},"a41cc5ea-47fb-4554-b4d9-c4e940ed4a44":{"position":{"vector":[-917,-29]}},"47119926-e01d-42e5-bf99-49d3a957182d":{"position":{"vector":[-293,69]}},"a76ea270-2455-4077-879d-45323314808c":{"position":{"vector":[-876,-122]}},"579ff032-0285-4443-9dc3-ffbf482da61f":{"position":{"vector":[151,117]}},"cd191e30-15c4-4fd6-89e5-0267e519d38a":{"position":{"vector":[-917,-209]},"visualization":{"show":true}},"cdf30e85-913b-4ace-aeff-45bbf42e5d39":{"position":{"vector":[-375,26]}},"299ecb1d-1c8f-4101-8a96-4b2ae97306a5":{"position":{"vector":[-603,-29]}},"e32181ee-79d0-4181-a09d-fc0fee344d1f":{"position":{"vector":[172,-16]}},"d2bbdedf-30e6-4576-b44c-fdae65bbc30e":{"position":{"vector":[-541,-323]}},"50d8f24a-9e84-4ca7-bfe6-8c83fc6c59fa":{"position":{"vector":[-603,-472]},"visualization":{"show":true,"width":1832.082258231373}},"d8cc6979-2125-45a2-80ba-647458da128a":{"position":{"vector":[353,-176]}},"8c936296-c1b7-4b30-9629-40eb41f3756a":{"position":{"vector":[1406,200]},"visualization":{"show":false,"width":857.3219477519232,"height":464.38130736092796}},"03dc7bf1-fcb1-4c8d-b7b8-fff267119843":{"position":{"vector":[1597,128]}},"8d3a9532-6c14-4912-b29f-79d240255583":{"position":{"vector":[183,-69]}},"a4d1b754-ebe1-409a-9d50-3ad0165bcef5":{"position":{"vector":[183,-69]}},"f82b920a-0801-4330-9745-3db57eea5dae":{"position":{"vector":[1596,56]}},"627e5011-9046-4513-bbb0-7ed9a4744dc9":{"position":{"vector":[224,-210]}},"c044904f-e9d9-46f9-abe4-bb1442b689d1":{"position":{"vector":[325,-109]}},"e3a11915-7834-43b4-ad42-ea363ab82ab2":{"position":{"vector":[1596,-16]}},"2c5aa2b8-9920-429c-bdb0-8c1ca9619a0f":{"position":{"vector":[312,-273]}},"69dc5492-fe42-4657-b44f-5e256f348eaf":{"position":{"vector":[1742,-79]}},"eb75fee5-6f54-4691-93f3-844fd511a2da":{"position":{"vector":[1496,-179]}},"e6764fa3-33ac-464c-8146-92b0fcf574c1":{"position":{"vector":[178,-608]}},"e2203002-efe7-4eb4-ac86-08b082859d82":{"position":{"vector":[1474,-251]},"visualization":{"show":false,"width":1251.6948377698768,"height":277.30814917939665}},"e5337399-313d-4156-897d-7033fa0a53c3":{"position":{"vector":[660,-563]}},"fcf764d6-8c90-4134-8a3f-a6f53bc29466":{"position":{"vector":[-957,237]},"visualization":{"show":false,"width":1887.6076074868763,"height":318.6546113052093}},"04ef082a-10b3-4d6b-9f10-a5fd89bd58fe":{"position":{"vector":[-552,167]}},"42e9eff0-4f8e-4f43-98e8-247cd00707bf":{"position":{"vector":[-552,167]}},"8f58cd4f-99ec-4991-a9e0-6ac180387601":{"position":{"vector":[1453,-323]},"visualization":{"show":false,"width":1574.637443680195,"height":354.5644264909765}},"039f69bd-26c2-4548-a42c-342ffbe6d6b4":{"position":{"vector":[1848,-544]}},"f9edd9a0-849e-4e0c-a372-c33e9a5b737b":{"position":{"vector":[1848,-544]}},"edbdf433-8ba3-4787-b3d9-f3442050f10d":{"position":{"vector":[1838,-555]}},"564fb8a6-4e6b-47b6-bba4-3819e9b1ac3a":{"position":{"vector":[1453,-395]},"visualization":{"show":true,"width":2878.9170863292707,"height":425.3593928753684}},"39acdb3c-3c92-4ab6-8222-9d310aea572a":{"position":{"vector":[1890,-617]}}},"widget":{},"snapshot":"eJyNVE1v2zgQvftXEO5BMZDl1nbcIAcdUidbBLvZBHXQHgxDmEgjmY3EUfjhJvvrFxJFm3Lspjdy3psPzgxfrqhiCwMyA5Xxz6CRiaomZRiU5SDvoQ/wWP4CvgIDj78McPl9cRz8QlSUmFzW4jjnVqSKNOXmOGUh6WdewtN77wAbErrjlnL9AlVdon4DfBPaQin+AyNI7sVtusdvQUgf+VqmlAlZHMrfI7aWweDDB3Yzv/uXFYpsPZC2QiXSRBswmuWixDED+XrO4gFjrDlOWOzsHIpCYQEGWUqlraSOl5xfblBBgc5p2N2Gp4zzW8wEyA5wF2cXUlS28oC7OQReQsTdWuQeVYrSiBLZR95VOBx/NGu2Q94SJ7OOOZm9wzyfdW+KncP5ew4Xff7FgVL8KJIr3Ih2lF01HmBbwL2eMt/G5jhcMZJJreixxErHnN8UkhS2Y0mplFAhi1u+n9TY3Sdco9lShvO2zqEnTR1pzBWSylAl3SzZMnLMaMU4/4w5KUzuzBpV4ux6G2EwqJq1chvybMk0iVFqaqr9ganhGRj4k0VrqOtXnZLCP4RMqUKe6k3UurlNi1nzn7lCyFwg/zpbyfF27wo0XaxFEysKSJM+6cvVfRR2o4vEU6pqa5CdNFMEpUl6/1EQbPo7Gc+OZNxgakg1SZcLA0ZoI1I+JyvNKdsZ7hVlNu2ZbhHkaXB1W99juC8Smt7uVhBi8YQ/Q/LfVhnSQoe2OW1ACZCp/8xnvTJ7TepBixpBVXAQ+5osni0ozDy4altjGuHZjWPqx5E82vLJN27H3M3U8RMhc/JTnbG4Y/EUtGHL6BuUFtnDa43t5s7XoDz5k9v1Gc9FaVCxE3ypFYtSkgaE1CfLne/qdPhXSWCGI0aKHWHcSIMFquEoGjHOb3TyoCwGuzFz+T651ei+ky/mgsWskWN+QHJDre1C8Qrq1i38uE7UG6FPrOwEZeIJZweEehkpLAQ1n3q5U95wtUPdfWN3Cr5v9pK/b9/X3n38gCCGlGBZprsp/yAh3fM5/wdzk9zZZpTLE86vny2Uetvo7WG08i0593GmXGFFGwzU7qso1oZ5zRv8DwqN4gw=","import":{}}}